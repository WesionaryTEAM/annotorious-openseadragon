<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Annotorious OpenSeadragon Example</title>
    <link
      href="https://fonts.googleapis.com/css?family=Lato&display=swap"
      rel="stylesheet"
    />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background-color: #e2e2e2;
        height: 100%;
        font-family: Lato;
        line-height: 160%;
      }

      .column {
        max-width: 700px;
        padding: 20px;
        margin: 0 auto;
        background-color: #fff;
        height: 100%;
        box-sizing: border-box;
      }

      h1 {
        font-size: 21px;
        font-weight: normal;
        margin: 0;
        padding: 0;
      }

      p.instructions {
        padding: 10px 0 30px 0;
      }

      .openseadragon-canvas {
        outline: none;
        background-color: #efefef !important;
      }
    </style>
    <script>
      window.onload = function () {
        var viewer = OpenSeadragon({
          id: "openseadragon",
          prefixUrl: "openseadragon/images/",
          tileSources: {
            type: "image",
            url: "1280px-Hallstatt.jpg",
          },
          gestureSettingsTouch: {
            pinchRotate: true,
          },
        });

        var anno = OpenSeadragon.Annotorious(viewer, {
          locale: "ja",
          tagVocabulary: [
            {
              label: "Right Lung",
              value: "right_lung",
              options: [
                "S1",
                "S2",
                "S3",
                "S4",
                "S5",
                "S6",
                "S7",
                "S8",
                "S9",
                "S10",
              ],
            },
            {
              label: "Left Lung",
              value: "left_lung",
              options: ["S1+2", "S3", "S4", "S5", "S6", "S8", "S9", "S10"],
            },
            {
              label: "Stomach",
              value: "stomach",
              options: [
                "U-Ant",
                "U-Post",
                "U-Less",
                "U-Gre",
                "M-Ant",
                "M-Post",
                "M-Less",
                "M-Gre",
                "L-Ant",
                "L-Post",
                "L-Less",
                "L-Gre",
              ],
            },
            {
              label: "Esophagus",
              value: "esophagus",
              options: ["Ant", "Post", "Less", "Gre"],
            },
            {
              label: "Cecum",
              value: "cecum",
              options: ["Cecum"],
            },
            {
              label: "Ascending colon",
              value: "ascending_colon",
              options: ["Ascending colon"],
            },
            {
              label: "Transverse colon",
              value: "transverse_colon",
              options: ["Transverse colon"],
            },
            {
              label: "Descending colon",
              value: "descending_colon",
              options: ["Descending colon"],
            },
            {
              label: "Sigmoid colon",
              value: "sigmoid_colon",
              options: ["Sigmoid colon"],
            },
            {
              label: "Rectum",
              value: "rectum",
              options: [
                "RS-Ant",
                "RS-Post",
                "RS-Lt",
                "RS-Rt",
                "Ra-Ant",
                "Ra-Post",
                "Ra-Lt",
                "Ra-Rt",
                "Rb-Ant",
                "Rb-Post",
                "Rb-Lt",
                "Rb-Rt",
              ],
            },
            {
              label: "Appendico",
              value: "appendico",
              options: ["Appendico"],
            },
            {
              label: "Anus",
              value: "anus",
              options: ["Ant", "Post", "Lt", "Rt"],
            },
          ],
          observationOptions: ["Surgical Materials", "Biospy", "Autopsy"],
          tagPlaceholder: "Enter organ",
          commentPlaceholder: "Add your review",
          maxCommentLength: 30,
        });

        anno.on("selectAnnotation", function (annotation) {
          console.log("selected", annotation);
        });

        anno.on("createAnnotation", function (a) {
          console.log("created", a);
        });

        anno.on("updateAnnotation", function (annotation, previous) {
          console.log("updated", previous, "with", annotation);
        });

        anno.on("deleteAnnotation", function (annotation) {
          console.log("deleted", annotation);
        });

        anno.on("mouseEnterAnnotation", function (annotation) {
          console.log("mouseEnter", annotation);
        });

        anno.on("mouseLeaveAnnotation", function (annotation) {
          console.log("mouseLeave", annotation);
        });

        anno.loadAnnotations("annotations.w3c.json");

        var toolToggle = document.getElementById("current-tool");
        toolToggle.addEventListener("click", function () {
          if (toolToggle.innerHTML == "RECTANGLE") {
            toolToggle.innerHTML = "POLYGON";
            anno.setDrawingTool("polygon");
          } else {
            toolToggle.innerHTML = "RECTANGLE";
            anno.setDrawingTool("rect");
          }
        });

        var toolToggle = document.getElementById("enable-draw");
        toolToggle.addEventListener("click", function () {
          anno.setDrawingEnabled(true);
        });
      };
    </script>
  </head>
  <body>
    <div class="column">
      <h1>Annotorious | OpenSeadragon Example</h1>
      <p class="instructions">
        Click the annotation to edit. Hold <strong>SHIFT</strong> while clicking
        and dragging the mouse to create a new annotation.
      </p>
      <p>
        <button id="current-tool">RECTANGLE</button>
        <button id="enable-draw">ENABLE DRAW</button>
      </p>
      <div id="openseadragon" style="width: 640px; height: 480px;"></div>
    </div>
    <script src="openseadragon/openseadragon.2.4.2.min.js"></script>
  </body>
</html>
